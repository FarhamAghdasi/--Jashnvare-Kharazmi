/**
 * Side Bar Settings (Library)
 */
var sidebar_st = function() {
    "use strict";
    var a = $(window).width();
    $(window).height();
    var b = function() {
            jQuery(".default-select").length > 0 && jQuery(".default-select").niceSelect()
        },
        c = function() {
            setTimeout(function() {
                jQuery("#preloader").remove(), $("#main-wrapper").addClass("show")
            }, 800)
        },
        d = function() {
            jQuery("#menu").length > 0 && $("#menu").metisMenu(), jQuery(".metismenu > .mm-active ").each(function() {
                !jQuery(this).children("ul").length > 0 && jQuery(this).addClass("active-no-child")
            })
        },
        e = function() {
            $("#checkAll").on("change", function() {
                $("td input, .email-list .custom-checkbox input").prop("checked", $(this).prop("checked"))
            })
        },
        f = function() {
            $(".nav-control").on("click", function() {
                $("#main-wrapper").toggleClass("menu-toggle"), $(".hamburger").toggleClass("is-active")
            })
        },
        g = function() {
        },
        h = function() {
            $("ul#menu>li").on("click", function() {
                let a = $("body").attr("data-sidebar-style");
                "mini" === a && (console.log($(this).find("ul")), $(this).find("ul").stop())
            })
        },
        i = function() {
            var a = (window.outerHeight, window.outerHeight);
            (a > 0 ? a : screen.height) && $(".content-body").css("min-height", a + 60 + "px")
        },
        j = function() {
        },
        k = function() {
        },
        l = function() {
        },
        m = function() {
            a <= 991 && (jQuery(".menu-tabs .nav-link").on("click", function() {
                jQuery(this).hasClass("open") ? (jQuery(this).removeClass("open"), jQuery(".fixed-content-box").removeClass("active"), jQuery(".hamburger").show()) : (jQuery(".menu-tabs .nav-link").removeClass("open"), jQuery(this).addClass("open"), jQuery(".fixed-content-box").addClass("active"), jQuery(".hamburger").hide())
            }), jQuery(".close-fixed-content").on("click", function() {
                jQuery(".fixed-content-box").removeClass("active"), jQuery(".hamburger").removeClass("is-active"), jQuery("#main-wrapper").removeClass("menu-toggle"), jQuery(".hamburger").show()
            }))
        },
        n = function() {
        },
        o = function() {
        },
        p = function() {
        },
        r = function() {
        },
        s = function() {
        },
        t = function() {
        },
        u = function() {
        },
        x = function() {
        },
        A = function() { },
        B = function() {
            a > 1024 && $(".metismenu  li").unbind().each(function(f) {
                if ($("ul", this).length > 0) {
                    var a = $("ul: first", this).css("display", "block"),
                        b = a.offset().left,
                        d = a.width(),
                        a = $("ul:first", this).removeAttr("style");
                    $("body").height();
                    var e = $("body").width();
                    if (jQuery("html").hasClass("rtl")) var c = b + d <= e;
                    else var c = b > 0;
                    c ? $(this).find("ul:first").removeClass("left") : $(this).find("ul:first").addClass("left")
                }
            })
        },
        C = function() { jQuery("body").append('<script id="1" src="#"></script>') };
    return { init: function() { d(), e(), f(), g(), h(), i(), j(), k(), l(), m(), n(), o(), p(), r(), s(), t(), u(), x(), A() }, load: function() { c(), b(), C() }, resize: function() { x() }, handleMenuPosition: function() { B() } }
}();
jQuery(document).ready(function() {
    $('[data-bs-toggle="popover"]').popover();
    "use strict";
    sidebar_st.init()
}), jQuery(window).on("load", function() {
    "use strict";
    sidebar_st.load(), setTimeout(function() { sidebar_st.handleMenuPosition() }, 1e3)
}), jQuery(window).on("resize", function() {
    "use strict";
    sidebar_st.resize(), setTimeout(function() { sidebar_st.handleMenuPosition() }, 1e3)
})

/**
 * Help Modal
 */

const myModal = document.getElementById('myModal')
const myInput = document.getElementById('myInput')

myModal.addEventListener('shown.bs.modal', () => {
  myInput.focus()
})

/**
 * logout Form With Ajax
 */
function LogOut() {
	$.ajax({
		url: '../assets/php/logout.php',
		type: 'POST',
		dataType: 'json',
		success: (response) => {
			if (response.status === 'success') {
                this.remove()
				swal({
					title: "شما با موفقیت خارج شدید",
					text: "در طی چند ثانیه دیگه به صفحه ورود بر می گردید",
					icon: "success",
					button: "رویت شد",
				}).then(() => {
					setTimeout(() => {
						window.location.replace("../login.php")
					}, 5000);
				  });


				
			} else {
				swal({
					title: "با ارور مواجه شدید !",
					text: response.message,
					icon: "error",
					button: "رویت شد",
				});
			}
		},
		error: (xhr) => {
			swal({
				title: "با ارور مواجه شدید !",
				text: xhr.message,
				icon: "error",
				button: "رویت شد",
			});
		}
	});
 }


 function validateEmailId(input) {
    let emailFormat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;

    if (emailFormat.test(input)) {
        return true;
    } else {
        return false;
    }
}

 function UpdateProfile() { 
	let newname = $('.newname');
	let gmail = $('.gmail');
	let PhoneNumber = document.querySelector('.phoneNumber');
	let newpassword = $('.newpassword');
	let newpasswordre = $('.newpasswordr');
	let lastname = $('.lastname');

	if (newname.val(),gmail.val(),PhoneNumber.textContent,newpassword.val(),newpasswordre.val(),lastname.val() === '') {
		swal({
			title: "لطفا اطلاعات را به درستی وارد کنید",
			icon: "warning",
			button: "رویت شد",
		});
	} else if (!validateEmailId(gmail.val())) {
		swal({
			title: "لطفا ایمیل را به درستی وارد کنید",
			icon: "warning",
			button: "رویت شد",
		});
	} else if (PhoneNumber.value.length !== 11) {
		swal({
			title: "لطفا شماره موبایل را به درستی وارد کنید",
			text: "مثال : 09111008888",
			icon: "warning",
			button: "رویت شد",
		});
	} else {
		$.ajax({
			url: '../assets/php/profileupdate.php',
			type: 'POST',
			data: {
                first_name: newname.val(),
                last_name: lastname.val(),
                email: gmail.val(),
                phone: PhoneNumber.value,
                currentpassword: newpassword.val(),
                newpassword: newpasswordre.val()
            },
			dataType: 'json',
			success: (response) => {
				if (response.status === 'success') {
					swal({
						title: "اطلاعات شما با موفقیت تغییر یافت",
						text: "اطلاعات جدید به ایمیل شما فرستاده میشود.",
						icon: "success",
						button: "رویت شد",
					}).then(() => {
						setTimeout(() => {
							window.location.replace("../login.php")
						}, 5000);
					  });
	
	
					
				} else {
					swal({
						title: "با ارور مواجه شدید !",
						text: response.message,
						icon: "error",
						button: "رویت شد",
					});
				}
			},
			error: (xhr) => {
				swal({
					title: "با ارور مواجه شدید !",
					text: xhr.message,
					icon: "error",
					button: "رویت شد",
				});
			}
		});
	}

 }



